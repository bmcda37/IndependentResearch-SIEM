# Wazuh Cluster

## Purpose
For this project, I will be using Wazuh as my SIEM tool. Wazuh provides a general installation guide at ``` ```; however, you will need to make changes to the configuration files which will be discussed in this README. The completed config files showing my specific configurations will be attached in the single-node folder within this repository.

# Wazuh Components

## Wazuh Manager

The Wazuh manager analyzes the data received from the agents. For processing the agent data, it uses decoders and rules while also incorporating threat intelligence. The Wazuh manager is also used to manage the agents, configuring and upgrading them remotely when necessary.

## Wazuh Indexer

 The Wazuh Indexer is a full-text search and analytics engine. This central component indexes and stores alerts generated by the Wazuh server.

## Wazuh Dashboard

The Wazuh Dashboard is the web user interface for data visualization and analysis. It includes out-of-the-box dashboards for security events, regulatory compliance (e.g., PCI DSS, GDPR, CIS, HIPAA, NIST 800-53), detected vulnerable applications, file integrity monitoring data, configuration assessment results, cloud infrastructure monitoring events, and others. It is also used to manage Wazuh configuration and to monitor its status.

## Configuring Wazuh-Manager for Vulnerability Detection & Centralizing Agent Management

1. Before configuring the Wazuh-Manager, ensure that you have enabled remote commands in your wazuh agent ```/var/ossec/etc/local_internal_options.conf```

Set: ```wazuh_command.remote_commands=1```
   
2. To configure the vulnerability module in Wazuh, you must first edit the Wazuh Manager's shared agent.conf file at: ```/var/ossec/etc/shared/default/agent.conf```. This configuration file is located in the shared directory, will allow the 

*The shared.conf file within the Wazuh-Manager allows the Wazuh-Manager to remotely configure and manage your Wazuh agents. It is important to remember that the agent.conf file takes precedence over the ossec.conf file, but while scanning the agent, the manager node aggregates both.*
   
```
<wodle name="syscollector">
   <disabled>no</disabled>
   <interval>1h</interval>
   <os>yes</os>
   <packages>yes</packages>
   <hotfixes>yes</hotfixes>
</wodle>
```
3. Next you will edit the Wazuh Manager's ossec.conf file at:```/var/ossec/etc/ossec.conf```

```
<vulnerability-detector>
    <enabled>yes</enabled>
    <interval>5m</interval>
    <min_full_scan_interval>6h</min_full_scan_interval>
    <run_on_start>yes</run_on_start>

    <!-- Ubuntu OS vulnerabilities -->
    <provider name="canonical">
      <enabled>yes</enabled>
      <os>trusty</os>
      <os>xenial</os>
      <os>bionic</os>
      <os>focal</os>
      <os>jammy</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Debian OS vulnerabilities -->
    <provider name="debian">
      <enabled>yes</enabled>
      <os>buster</os>
      <os>bullseye</os>
      <os>bookworm</os>
      <update_interval>1h</update_interval>
    </provider>
```

4. Lastly, restart the Wazuh-Manager using ```systemctl restart wazuh-manager```

# Kali Linux VM 
To configure your Kali Linux machine to be scanned for vulnerabilities, you will need to extend support using the following code:

```
<provider name="debian">
    <enabled>yes</enabled>
    <os allow="Kali GNU/Linux-2023">bookworm</os>
    <update_interval>1h</update_interval>
</provider>
```
